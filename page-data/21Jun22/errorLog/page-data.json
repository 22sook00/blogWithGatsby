{"componentChunkName":"component---src-templates-post-detail-tsx","path":"/21Jun22/errorLog/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>Before I start ..</h2>\n<p>빌드에러 하나 없이 무사히 배포를 했다고 생각했는데 실배포에서 해당이슈가 발생해버렸다.<br/>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/859293754059262cde9f88eebc43ada7/b38ab/err1.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.45833333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAABuUlEQVQ4y32UibKiMBBF/f+PHEqUTVAB2ZfuV6d97TCik6prOokcbjodDiqiyzhp23U6jqNO0/TqXYyHYTDN82xjtCyL0kTERDuoqPZFpX+CQNM01dvtppfLxfosy2wOMefjMAxN9/t9DxQVHeZJq6rStm2tR2VZatd1psfjYY76vrfYnTls2w5MtOOgcRxrURR6Op30fD6bA1ziAnc483VevIVtoQfCbhw0z3N7oGkarevaRIxTHL872W5zBzSHUWQueBhnwIF5/A58B//NoYhWZWn5QbgiTwigO2Xrnl9egra5dLgBu763kgDY/ZYPPRCH8gLACChzAHcO+eFhTzoADsFL4n/NQeu6/gvk1JIkMdD1en3B/Y/f9OmADMhtAMR2ACPKiPIhplSiKProkLZz6MULlK061IH+Ar81x+PRDsWhOyDJRdu7672LO4yY9zv9Fbid/Ba/53Nd5WVkW+CvHPq2PGd8CNhaksQ2DoLA8kjMrTqFoa0znsZxD+SEUZwkmmV8XXJNKtG8Eb08RItGNa1Fs1psLb2PmtY+92HLnj/P00S/iM6LPPv1GdvY1lebR8MsQAz4A8oyJ1s7Aj0cAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/859293754059262cde9f88eebc43ada7/a59e9/err1.webp 192w,\n/static/859293754059262cde9f88eebc43ada7/0ca9f/err1.webp 384w,\n/static/859293754059262cde9f88eebc43ada7/dc9b9/err1.webp 768w,\n/static/859293754059262cde9f88eebc43ada7/e2c2f/err1.webp 1152w,\n/static/859293754059262cde9f88eebc43ada7/ba85f/err1.webp 1168w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/webp\">\n          <source srcset=\"/static/859293754059262cde9f88eebc43ada7/3b721/err1.png 192w,\n/static/859293754059262cde9f88eebc43ada7/66595/err1.png 384w,\n/static/859293754059262cde9f88eebc43ada7/fe486/err1.png 768w,\n/static/859293754059262cde9f88eebc43ada7/d2d74/err1.png 1152w,\n/static/859293754059262cde9f88eebc43ada7/b38ab/err1.png 1168w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/859293754059262cde9f88eebc43ada7/fe486/err1.png\" alt=\"error-issue\" title=\"error-issue\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span></p>\n<p>똥줄타는 마음으로 에러링크를 타고 들어갔더니\n<br/>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 643px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/8a5a87c75c53040708128fd43eca152e/45cbc/err2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 110.41666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAACsklEQVQ4y52Ux0/jUBDGfaEIBDjFiZ3QQ0LIppEQOqIIIQRCwIED/QDcuPD/H77Vb+B5nWgVrfbweWZeGU/55nkLCwu6vb3V6+urnp+fdXh4qMvLS93c3Oju7k5nZ2e6uLjQycmJndvd3dX+/r5OT09tb2trSzMzM0qlUgavUCjo6upKn5+fen9/19vbm+7v7+3y09OTHh4e9PHxYRcfHx/NOXsvLy/6+vqyu1NTU38cTk9Py/O8oZiYmNDk5KRGRkY0Pj6usbExjY6OmiNsHPm+b/CCINDe3p4ODg7idLa3tw3Y6+vrSqfTdimTyZiOBKy5PefUy+VyOj8/1/X1tY6Ojqwux8fHsXNS5SB1GgbOWMp8SJu0SIHUkIB1ZDabVT6fFz8flGEYmk7EFiEGUezs7FiaGxsbpnc6HW1ubprd6/W0vLys1dVVVatV05ErKyuqVCoql8uKosgi9agBRrFYtD/R9TCKvuXP34GL2GHQdtSxlHEYhZHCfF5RPlQxKihPWkHue+8H/HwYYoeNRkP1ZkPVVlO1TluNXlflXzXTS5Wy5ufnNTs7G3fzb+hz6GiQzmaUCQKls1lDJhfIT6X6uvhPDg0+8A1+AsOcDMK6zGewyO6Pydr8S3TmEI5BA7C0tCQeC6bnf6KzlPEO35gKpgNOQhcXMfVLykE9SZk4ZRg/NzdnjpBEScQQFr1UKmlxcdEygMysOd3ZMQ9xyEUmo16vq9ls2kQg2+22UcrJtbU1tVotmw4kVHIj2DfLTAmb0c+ERIlJcXZyDydI6k+9kfF7iGci6Ha7FiFzy5PFGsBGEhFnmG10ak3t2Yf4faPHAmm7urmuUzuko4+7hO5SdLTri5B03XgBGgMoBXCpoyNJGd2dS1ItdkgkrrsuMjrpdBoBsN16rVazZ4ySuOfrN1fST9SJKAbGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/8a5a87c75c53040708128fd43eca152e/a59e9/err2.webp 192w,\n/static/8a5a87c75c53040708128fd43eca152e/0ca9f/err2.webp 384w,\n/static/8a5a87c75c53040708128fd43eca152e/e3893/err2.webp 643w\" sizes=\"(max-width: 643px) 100vw, 643px\" type=\"image/webp\">\n          <source srcset=\"/static/8a5a87c75c53040708128fd43eca152e/3b721/err2.png 192w,\n/static/8a5a87c75c53040708128fd43eca152e/66595/err2.png 384w,\n/static/8a5a87c75c53040708128fd43eca152e/45cbc/err2.png 643w\" sizes=\"(max-width: 643px) 100vw, 643px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/8a5a87c75c53040708128fd43eca152e/45cbc/err2.png\" alt=\"error-issue\" title=\"error-issue\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<br/></p>\n<p>공식문서에 나와있는게 전부이고 다른 리뷰들은 찾아볼수가 없었다. ㅠㅠ 나만 이런에러가 난건가? 하고 계속 삽질 한 결과,\n한 페이지를 가져올때 maximum value는 10MB라고 한다.\n아래의 사진을 보면 메모리 사용량이 720MB인 것을 보면 굉장히 많은 메모리를 사용하고 있는 것으로 보여진다.\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/2aa3156e92ca699d000c352a2aac462b/583a7/err3.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 31.770833333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAoElEQVQY052QSw7DIAxEOUHjMaRN0u+iP6ld9v5Xm8rElhDLLJ5sEB4Pky4KZoAKocg2bPao4AQwvbLynpVnBU8KioDAdtJvzPwW5QxU4QJwJ8KhI9wMXe1Jn6I0l2b3kbW6tBiuDTcF90BdFnXEGtXozkysOjSB2XN851U8eHoUhv3AcoqsFgUPXrUVtIvF84uh6G1gcuw8+9sQjL4V/ANzGpIn+OKAuQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/2aa3156e92ca699d000c352a2aac462b/a59e9/err3.webp 192w,\n/static/2aa3156e92ca699d000c352a2aac462b/0ca9f/err3.webp 384w,\n/static/2aa3156e92ca699d000c352a2aac462b/dc9b9/err3.webp 768w,\n/static/2aa3156e92ca699d000c352a2aac462b/b597c/err3.webp 1013w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/webp\">\n          <source srcset=\"/static/2aa3156e92ca699d000c352a2aac462b/3b721/err3.png 192w,\n/static/2aa3156e92ca699d000c352a2aac462b/66595/err3.png 384w,\n/static/2aa3156e92ca699d000c352a2aac462b/fe486/err3.png 768w,\n/static/2aa3156e92ca699d000c352a2aac462b/583a7/err3.png 1013w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/2aa3156e92ca699d000c352a2aac462b/fe486/err3.png\" alt=\"error-issue\" title=\"error-issue\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span></p>\n<h3>알고보니</h3>\n<p>하필 이때 테크리더님은 병가여서 오로지 혼자 해결했어야 했는데 급한대로 Vercel 에서 Amplify 로 옮겨두었다.\n이상하게 옮기니까 되는 매직~\n일단 실서버에서 잘돌아가는 것을 확인했으니 본격 에러를 잡아보자.</p>\n<p>멀쩡하게 잘 돌아가던 프로젝트가 왜 갑자기 빌드에러를 내었을까\n실배포 main 브랜치와 어떤코드 변경이 있었는지 하나씩 로그를 찾아보던 결과,\n프로덕션 서버에서만 에러로그를 확인할 수 있는 sentry 를 install 할때 환경변수를 건드린게 문제였다.\n프로덕션 서버일때 콘솔을 뱉게 한다. 이런식으로 코드를 작성했는데\nnode.env === ‘production’ ? ~~\n가 아닌\nnode.env === ‘main’\n이렇게 작성했어야 했다.</p>\n<p>그렇게 20분간의 실서버 중단이 이뤄졌고 대표님에게 끌려갔다는 이야기 ,, 총총</p>\n<p>환경변수는 왠만하면 건드리지말자 .. ,, !</p>","frontmatter":{"title":"지옥의 에러로그","summary":"환경변수는 정말 조심히 건드리자.","date":"2022.06.21.","categories":["bugFix","git","deploy"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAABuUlEQVQ4y32UibKiMBBF/f+PHEqUTVAB2ZfuV6d97TCik6prOokcbjodDiqiyzhp23U6jqNO0/TqXYyHYTDN82xjtCyL0kTERDuoqPZFpX+CQNM01dvtppfLxfosy2wOMefjMAxN9/t9DxQVHeZJq6rStm2tR2VZatd1psfjYY76vrfYnTls2w5MtOOgcRxrURR6Op30fD6bA1ziAnc483VevIVtoQfCbhw0z3N7oGkarevaRIxTHL872W5zBzSHUWQueBhnwIF5/A58B//NoYhWZWn5QbgiTwigO2Xrnl9egra5dLgBu763kgDY/ZYPPRCH8gLACChzAHcO+eFhTzoADsFL4n/NQeu6/gvk1JIkMdD1en3B/Y/f9OmADMhtAMR2ACPKiPIhplSiKProkLZz6MULlK061IH+Ar81x+PRDsWhOyDJRdu7672LO4yY9zv9Fbid/Ba/53Nd5WVkW+CvHPq2PGd8CNhaksQ2DoLA8kjMrTqFoa0znsZxD+SEUZwkmmV8XXJNKtG8Eb08RItGNa1Fs1psLb2PmtY+92HLnj/P00S/iM6LPPv1GdvY1lebR8MsQAz4A8oyJ1s7Aj0cAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/859293754059262cde9f88eebc43ada7/8537d/err1.png","srcSet":"/static/859293754059262cde9f88eebc43ada7/ac51d/err1.png 292w,\n/static/859293754059262cde9f88eebc43ada7/38f62/err1.png 584w,\n/static/859293754059262cde9f88eebc43ada7/8537d/err1.png 1168w","sizes":"(min-width: 1168px) 1168px, 100vw"},"sources":[{"srcSet":"/static/859293754059262cde9f88eebc43ada7/60528/err1.webp 292w,\n/static/859293754059262cde9f88eebc43ada7/0bc1a/err1.webp 584w,\n/static/859293754059262cde9f88eebc43ada7/0998f/err1.webp 1168w","type":"image/webp","sizes":"(min-width: 1168px) 1168px, 100vw"}]},"width":1168,"height":1012}},"publicURL":"/static/859293754059262cde9f88eebc43ada7/err1.png"}}}}]}},"pageContext":{"slug":"/21Jun22/errorLog/"}},"staticQueryHashes":[]}